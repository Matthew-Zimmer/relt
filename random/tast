[relt.typed.function("deltaFileSource", [relt.typed.declare(relt.typed.id("info"), relt.type.id("DeltaSourceInfo")), relt.typed.declare(relt.typed.id("prev"), relt.type.id("ReltTableHook"))], relt.typed.object([relt.typed.assign(relt.typed.id("emitDataset"), relt.typed.lambda([relt.typed.declare(relt.typed.id("ctx"), relt.type.id("EmitDatasetContext"))], relt.typed.block([relt.typed.app(relt.typed.dot(relt.typed.app(relt.typed.app(relt.typed.dot(relt.typed.id("ctx"), relt.typed.id("load")), relt.typed.string("deltaFileSourceHelper")), relt.typed.string("file://$RELT_HOME/templates/utils/deltaFileSourceDatasetHandler.scala")), relt.typed.id("emitOnce")), relt.typed.block([])), relt.typed.let(relt.typed.assign(relt.typed.id("t"), relt.typed.app(relt.typed.app(relt.typed.dot(relt.typed.id("ctx"), relt.typed.id("load")), relt.typed.add(relt.typed.dot(relt.typed.id("ctx"), relt.typed.id("name")), "+", relt.typed.string("deltaFileSource"))), relt.typed.string("file://$RELT_HOME/templates/deltaFileSourceDatasetHandler.scala")))), relt.typed.app(relt.typed.app(relt.typed.dot(relt.typed.id("t"), relt.typed.id("replace")), relt.typed.string("_TO_DSS_")), relt.typed.dot(relt.typed.id("ctx"), relt.typed.id("toDss"))), relt.typed.app(relt.typed.app(relt.typed.dot(relt.typed.id("t"), relt.typed.id("replace")), relt.typed.string("_TO_DS_")), relt.typed.dot(relt.typed.id("ctx"), relt.typed.id("toDs"))), relt.typed.app(relt.typed.app(relt.typed.dot(relt.typed.id("t"), relt.typed.id("replace")), relt.typed.string("_NAME_")), relt.typed.dot(relt.typed.id("ctx"), relt.typed.id("name"))), relt.typed.app(relt.typed.app(relt.typed.dot(relt.typed.id("t"), relt.typed.id("replace")), relt.typed.string("_PROJECT_")), relt.typed.dot(relt.typed.id("ctx"), relt.typed.id("project"))), relt.typed.app(relt.typed.app(relt.typed.dot(relt.typed.id("t"), relt.typed.id("replace")), relt.typed.string("_TYPE_")), relt.typed.dot(relt.typed.id("ctx"), relt.typed.id("typeName"))), relt.typed.app(relt.typed.dot(relt.typed.id("t"), relt.typed.id("emit")), relt.typed.block([])), relt.typed.object([relt.typed.assign(relt.typed.id("name"), relt.typed.add(relt.typed.dot(relt.typed.id("ctx"), relt.typed.id("name")), "+", relt.typed.string("DeltaFileSourceDatasetHandler")))])])))])), relt.typed.let(relt.typed.assign(relt.typed.id("myDeltaFile"), relt.typed.app(relt.typed.id("deltaFileSource"), relt.typed.object([relt.typed.assign(relt.typed.id("path"), relt.typed.string("s3://path/to/delta/file"))])))), relt.typed.table(relt.typed.assign(relt.typed.id("x"), relt.typed.object([relt.typed.declare(relt.typed.id("id"), relt.type.int)])), [relt.typed.id("myDeltaFile")]), relt.typed.table(relt.typed.assign(relt.typed.id("y"), relt.typed.union(relt.typed.id("x"), relt.typed.id("x"))), [])]